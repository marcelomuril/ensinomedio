<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Aptidão (Versão Final)</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --bg-color: #f0f2f5;
            --card-bg-color: #ffffff;
            --primary-text-color: #1c1e21;
            --secondary-text-color: #606770;
            --primary-color: #0d6efd;
            --secondary-color: #6c757d;
            --accent-color: #198754;
            --border-color: #dee2e6;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color);
            color: var(--primary-text-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: auto;
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
        }
        
        /* Seção do Gráfico */
        .dashboard {
            background: var(--card-bg-color);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 40px;
        }

        .dashboard h2 {
            font-size: 1.5rem;
            margin-top: 0;
            text-align: center;
            color: var(--secondary-text-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .chart-container {
            position: relative;
            height: 380px;
            width: 100%;
            max-width: 480px;
            margin: auto;
        }

        /* Seção da Tabela de Dados */
        .data-section {
            background: var(--card-bg-color);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 30px;
        }
        
        .filters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .filters label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-text-color);
        }
        
        .filters select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            background-color: #fff;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23606770%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 15px top 50%;
            background-size: 0.65em auto;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .filters select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.25);
        }

        .table-wrapper { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 15px; text-align: left; border-bottom: 1px solid var(--border-color); }
        th { background-color: var(--primary-color); color: white; font-weight: 600; }
        th:first-child { border-top-left-radius: 8px; }
        th:last-child { border-top-right-radius: 8px; }
        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #f8f9fa; }

        #count {
            text-align: right;
            margin-top: 15px;
            font-style: italic;
            color: var(--secondary-text-color);
        }
        
        @media (max-width: 768px) {
            .filters { grid-template-columns: 1fr; }
            header h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Dashboard de Aptidões</h1>
        </header>

        <section class="dashboard">
            <h2>Resultado Geral por Aptidão</h2>
            <div class="chart-container">
                <canvas id="aptitudeChart"></canvas>
            </div>
        </section>

        <section class="data-section">
            <div class="filters">
                <div>
                    <label for="nameFilter">Filtrar por Nome:</label>
                    <select id="nameFilter"></select>
                </div>
                <div>
                    <label for="aptitudeFilter">Filtrar por Aptidão:</label>
                    <select id="aptitudeFilter"></select>
                </div>
            </div>
            <div id="count"></div>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Turma</th>
                            <th>Aptidão Principal</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable">
                        </tbody>
                </table>
            </div>
        </section>
    </div>

    <script>
        // Dados completos e corrigidos da planilha
        const studentData = [
            {"nome": "Yasmin da Silva Lopes", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "Kyara Carnetti Fernandes", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "Eduardo Miguel de Oliveira Camargo", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "liliane guedes andrade", "turma": "9D", "aptidao": "Técnico em Agropecuária"},
            {"nome": "ana clara dos santos", "turma": "9D", "aptidao": "Técnico em Agropecuária"},
            {"nome": "João vitor sonza minosso", "turma": "9D", "aptidao": "Técnico em Administração"},
            {"nome": "MARIA VITORIA BRIZOLA", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "Beatriz Constance Koether Muller", "turma": "9D", "aptidao": "Técnico em Administração"},
            {"nome": "ANDRESSA DOS SANTOS", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "Lorenzo Serafim Funari", "turma": "9D", "aptidao": "Técnico em Administração"},
            {"nome": "gabrieloliveiramoreno", "turma": "9D", "aptidao": "Linguagens"},
            {"nome": "Victor Palhano Oliveira", "turma": "9D", "aptidao": "Linguagens"},
            {"nome": "Maria Fernanda Costa Ziguer Almeida", "turma": "9D", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Andersson Gabriel Elizio Gonçalves", "turma": "9D", "aptidao": "Linguagens"},
            {"nome": "Maria Beatriz Schneider", "turma": "9D", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Vinicius Da Silva Corvalan", "turma": "9D", "aptidao": "Linguagens"},
            {"nome": "Allana Estefany Santos Martins", "turma": "9D", "aptidao": "Ciências da Natureza"},
            {"nome": "natalia aparecida arient dos anjos", "turma": "9D", "aptidao": "Humanas"},
            {"nome": "jose lucas oliveira camargo", "turma": "9D", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Richard Wesley Braga Bello", "turma": "9D", "aptidao": "Ciências da Natureza"},
            {"nome": "renan mateus ribas", "turma": "9D", "aptidao": "Técnico em Administração"},
            {"nome": "Gustavo Taques Fernandes", "turma": "9D", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "eloisa.souza09@escola.pr.gov.br", "turma": "9D", "aptidao": "Linguagens"},
            {"nome": "izabella stingelin de melo", "turma": "9C", "aptidao": "Humanas"},
            {"nome": "João Vitor Da Silva Padilha", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "felipe da silva ramos", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Alexander Silvestre Vieira", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "kemuel carlos", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Victor Eduardo Cerutti Silva", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "jose marcos rocha arient", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "André Felipe Teixeira Fiorin", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "gabriela lara groze", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Pedro Henrique correia de oliveira", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "willian schmidt de lima", "turma": "9C", "aptidao": "Ciências da Natureza"},
            {"nome": "izabel do nascimento da silva", "turma": "9C", "aptidao": "Técnico em Agropecuária"},
            {"nome": "isadora tesseroli ribeiro", "turma": "9C", "aptidao": "Humanas"},
            {"nome": "Laura Regina Teixeira Cenci", "turma": "9C", "aptidao": "Linguagens"},
            {"nome": "Isaque Guillande Nunes", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "brayan cruz de andrade", "turma": "9C", "aptidao": "Linguagens"},
            {"nome": "Luiz Henrique da Rocha", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Cristofer jesus dos anjos", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Lauren Dos Santos Pereira", "turma": "9C", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Nathalyelen Markoski Pacheco", "turma": "9C", "aptidao": "Técnico em Administração"},
            {"nome": "Karoline Ramirio da Silva", "turma": "9C", "aptidao": "Humanas"},
            {"nome": "gilson gabriel silvestri tavares", "turma": "9C", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Peterson antonio camargo da costa", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "welinton guilherme antunes silveira", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "vinicius gabriel tortato", "turma": "9C", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Natalia Ferreira Bittencourt Avila", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Yasmin da Silva Araujo", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "kethelyn apulinario silva", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "Arthur Metzler Moraes", "turma": "9A", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Lauren Gabrieli da Silva Machado", "turma": "9A", "aptidao": "Ciências da Natureza"},
            {"nome": "Antônia Gritten Oliveira", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "José Augusto da rocha silveira", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Vinicius Estene Pedroso", "turma": "9A", "aptidao": "Técnico em Administração"},
            {"nome": "Sofia Zambonin Siqueira", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Salma Ali Makki", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Allana de Almeida Cardoso", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "pedro henrique carlin", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Alice Metzler Bueno", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "Sebastian Da Silva Guedes", "turma": "9A", "aptidao": "Técnico em Administração"},
            {"nome": "Gabriel Henrique Guedes", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Hisabella Turatto", "turma": "9A", "aptidao": "Técnico em Administração"},
            {"nome": "Renan guilherme leiria kohler", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Arthur Henrique Birnfeld Carlim", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Pedro Antonio Taques dos Santos", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Jhennifer Victoria Ribas de Almeida Pasqual", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "davi pietro", "turma": "9A", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "pedro henrique antunes leite", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Andrya Vitória Dassoglio", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "Marcos Eduardo Pontes Chuarts", "turma": "9A", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Diulia Gabrielly Favetti de Oliveira", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Kethelin Zaini Martins", "turma": "9A", "aptidao": "Humanas"},
            {"nome": "Luara Fernanda Mendes", "turma": "9A", "aptidao": "Ciências da Natureza"},
            {"nome": "gislaine vitoria da silva valentin", "turma": "9A", "aptidao": "Técnico em Administração"},
            {"nome": "João Pedro Eufrazio Bomer", "turma": "9A", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "haziellah pires de souza", "turma": "9A", "aptidao": "Técnico em Agropecuária"},
            {"nome": "eder rafael vais de mello", "turma": "9A", "aptidao": "Linguagens"},
            {"nome": "Maitê Serafini da Silva", "turma": "9A", "aptidao": "Técnico em Administração"},
            {"nome": "Helena Vitória Ferreira Pelentier", "turma": "9F", "aptidao": "Ciências da Natureza"},
            {"nome": "bruna barbosa fonseca", "turma": "9F", "aptidao": "Técnico em Administração"},
            {"nome": "raysa vitória correa", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "naiara moraes de camargo", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "Erick Mateus Buff MUNHYOZ", "turma": "9F", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Rafaela Aparecida Rother", "turma": "9F", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Vitor Gabriel Vieira Matuella", "turma": "9F", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Rafaela Aparecida Rother", "turma": "9F", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Gabriel Portes Machado Borges", "turma": "9F", "aptidao": "Ciências da Natureza"},
            {"nome": "Isabela Gonçalves Kovari", "turma": "9F", "aptidao": "Ciências da Natureza"},
            {"nome": "Thiffani Gabrieli Ribeiro Bueno", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "Marcos Vinicius Marta da Silva", "turma": "9F", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Ana Beatriz da Silva Buff", "turma": "9F", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Julia Vanessa Rempel Pinheiro de Miranda", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "enzo henrique ribeiro ramos", "turma": "9F", "aptidao": "Ciências da Natureza"},
            {"nome": "Gabrielly Garcia Carus", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "nicoli dos santos da silva", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "emmanuelle maria oliveira da silva", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "Tainara Aparecida da Cruz Machado", "turma": "9F", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "giovana da silva lima", "turma": "9F", "aptidao": "Linguagens"},
            {"nome": "rakelly morais lara", "turma": "9F", "aptidao": "Humanas"},
            {"nome": "natanael felipe souza", "turma": "9F", "aptidao": "Técnico em Agropecuária"},
            {"nome": "jeniffer amanda lopes", "turma": "9F", "aptidao": "Técnico em Administração"},
            {"nome": "estefani ribeiro", "turma": "9E", "aptidao": "Técnico em Administração"},
            {"nome": "vitoria cristina dos santos", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "luiz otavio berlesi dalsegio", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "adrian gabriel lima", "turma": "9F", "aptidao": "Técnico em Administração"},
            {"nome": "brayan gabriel dos santos lauer", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Amanda da Luz Maciel", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "adrielly munis geraldo", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Bernardo Maximiliano Maximus Abi", "turma": "9E", "aptidao": "Linguagens"},
            {"nome": "eloize souza de andrade", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Luis Miguel Costa Caliberda", "turma": "9E", "aptidao": "Ciências da Natureza"},
            {"nome": "Analice Assmann", "turma": "9E", "aptidao": "Ciências da Natureza"},
            {"nome": "Andressa Camargo", "turma": "9E", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Alana Martins mereles", "turma": "9E", "aptidao": "Ciências da Natureza"},
            {"nome": "Isabelly Victória Marchiori Lens Marcondes", "turma": "9E", "aptidao": "Linguagens"},
            {"nome": "DIULYA ARIELA ZANON PAGESKI", "turma": "9E", "aptidao": "Ciências da Natureza"},
            {"nome": "Brendah Brasil", "turma": "9E", "aptidao": "Ciências da Natureza"},
            {"nome": "Vanessa Dos Santos Alves", "turma": "9E", "aptidao": "Linguagens"},
            {"nome": "Hanyel Carlos Selle Rodrigues", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Jose Francisco Debas Grando", "turma": "9E", "aptidao": "Linguagens"},
            {"nome": "Samuel Henrique dos santos da silva", "turma": "9E", "aptidao": "Técnico em Administração"},
            {"nome": "keila guedes santos lustoza", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "hillary rodrigues mazeica", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "keila guedes santos lustoza", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "gabriellafernandesoliveirabatista", "turma": "9E", "aptidao": "Técnico em Agropecuária"},
            {"nome": "lucas santos amorim campelo", "turma": "9B", "aptidao": "Ciências da Natureza"},
            {"nome": "Milena do nascimento silva", "turma": "9B", "aptidao": "Humanas"},
            {"nome": "Amanda Lemos De Lima", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Kaue wesley araujo alves", "turma": "9B", "aptidao": "Técnico em Administração"},
            {"nome": "jheniffer cristina dos santos ferreira", "turma": "9B", "aptidao": "Ciências da Natureza"},
            {"nome": "valentina conte fragoso", "turma": "9B", "aptidao": "Técnico em Administração"},
            {"nome": "maria gabrielly correa", "turma": "9B", "aptidao": "Técnico em Administração"},
            {"nome": "anna jullya santos oliveira", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Adryel xavier lechinoski", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "arthur henrique perin", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Trynnity Abreu", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Isabely Doner dos Santos", "turma": "9B", "aptidao": "Técnico em Agropecuária"},
            {"nome": "joao vinicius dos santos ruthes", "turma": "9B", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Raul Lustoza Matte", "turma": "9B", "aptidao": "Técnico em Eletromecânica"},
            {"nome": "Jhonathan Henrique Ribeiro", "turma": "9B", "aptidao": "Técnico em Agropecuária"},
            {"nome": "Gustavo Santos Moraes", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Eros hebrayn Ferraz palhano", "turma": "9B", "aptidao": "Técnico em Administração"},
            {"nome": "Antonio Caio de Oliveira Camargo", "turma": "9B", "aptidao": "Linguagens"},
            {"nome": "Mauriem Sabrina dos santos", "turma": "9B", "aptidao": "Humanas"},
            {"nome": "MARIANNA ZIGUER CAESAR", "turma": "9B", "aptidao": "Técnico em Administração"},
            {"nome": "lorenzo.bello", "turma": "9B", "aptidao": "Humanas"},
            {"nome": "Thayla cristina santana rosa", "turma": "9B", "aptidao": "Humanas"},
            {"nome": "Deisi Ariely dos Santos Dorneles", "turma": "9B", "aptidao": "Humanas"},
            {"nome": "Aysha Catarina Dangelis dos Santos", "turma": "9B", "aptidao": "Linguagens"}
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const nameFilter = document.getElementById('nameFilter');
            const aptitudeFilter = document.getElementById('aptitudeFilter');
            const dataTable = document.getElementById('dataTable');
            const countElement = document.getElementById('count');

            // Limpa os dados, como remover espaços extras
            const cleanData = studentData.map(student => ({
                ...student,
                aptidao: student.aptidao.trim()
            }));

            // --- Lógica do Gráfico ---
            const aptitudeCounts = cleanData.reduce((acc, student) => {
                acc[student.aptidao] = (acc[student.aptidao] || 0) + 1;
                return acc;
            }, {});

            const chartLabels = Object.keys(aptitudeCounts);
            const chartData = Object.values(aptitudeCounts);
            const chartColors = ['#0d6efd', '#ffc107', '#dc3545', '#0dcaf0', '#6f42c1', '#fd7e14'];
            const ctx = document.getElementById('aptitudeChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut', data: { labels: chartLabels, datasets: [{ label: 'Número de Alunos', data: chartData, backgroundColor: chartColors, borderColor: '#ffffff', borderWidth: 3, hoverOffset: 10 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top', labels: { font: { family: 'Poppins', size: 14 } } }, tooltip: { callbacks: { label: function(context) { const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0); const value = context.raw; const percentage = ((value / total) * 100).toFixed(1); return `${context.label}: ${value} alunos (${percentage}%)`; } } } } }
            });

            // --- Lógica da Tabela e Filtros ---
            function populateFilters() {
                const names = [...new Set(cleanData.map(s => s.nome))].sort((a, b) => a.localeCompare(b));
                nameFilter.innerHTML = '<option value="">Todos os Alunos</option>';
                names.forEach(name => { nameFilter.innerHTML += `<option value="${name}">${name}</option>`; });

                const aptitudes = [...new Set(cleanData.map(s => s.aptidao))].sort();
                aptitudeFilter.innerHTML = '<option value="">Todas as Aptidões</option>';
                aptitudes.forEach(aptitude => { aptitudeFilter.innerHTML += `<option value="${aptitude}">${aptitude}</option>`; });
            }

            function populateTable(data) {
                dataTable.innerHTML = '';
                data.forEach(student => {
                    const row = document.createElement('tr');
                    row.innerHTML = `<td>${student.nome}</td><td>${student.turma}</td><td>${student.aptidao}</td>`;
                    dataTable.appendChild(row);
                });
                countElement.textContent = `Exibindo ${data.length} de ${cleanData.length} registros.`;
            }

            function filterData() {
                const nameValue = nameFilter.value;
                const aptitudeValue = aptitudeFilter.value;
                const filteredData = cleanData.filter(student => {
                    const nameMatch = nameValue === "" || student.nome === nameValue;
                    const aptitudeMatch = aptitudeValue === "" || student.aptidao === aptitudeValue;
                    return nameMatch && aptitudeMatch;
                });
                populateTable(filteredData);
            }

            nameFilter.addEventListener('change', filterData);
            aptitudeFilter.addEventListener('change', filterData);

            populateFilters();
            populateTable(cleanData);
        });
    </script>

</body>
</html>
